{% extends "base.html" %}

{% block title %}ğŸ“ Ø§Ù„Ù…Ø¯ÙˆÙ†Ø© - CyberShield Ultra{% endblock %}

{% block meta_description %}Ù…Ø¯ÙˆÙ†Ø© Ø§Ù„Ø£Ù…Ù† Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©. Ù…Ù‚Ø§Ù„Ø§Øª ÙˆØ¯Ø±ÙˆØ³ ÙÙŠ Ø£Ù…Ù† Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§ØªØŒ Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø®ØµÙˆØµÙŠØ©ØŒ ÙˆØ£Ø¯ÙˆØ§Øª Ø§Ù„ÙØ­Øµ.{% endblock %}

{% block meta_keywords %}Ù…Ø¯ÙˆÙ†Ø©, Ø£Ù…Ù† Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ, Ù…Ù‚Ø§Ù„Ø§Øª, Ø¯Ø±ÙˆØ³, Ø­Ù…Ø§ÙŠØ©{% endblock %}

{% block og_title %}ğŸ“ Ù…Ø¯ÙˆÙ†Ø© Ø§Ù„Ø£Ù…Ù† Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ - CyberShield Ultra{% endblock %}

{% block og_description %}Ù…Ù‚Ø§Ù„Ø§Øª ÙˆØ¯Ø±ÙˆØ³ ÙÙŠ Ø£Ù…Ù† Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ÙˆØ­Ù…Ø§ÙŠØ© Ø§Ù„Ø®ØµÙˆØµÙŠØ©.{% endblock %}

{% block styles %}
<style>
    .blog-hero {
        background: radial-gradient(circle at 50% 50%, rgba(245, 158, 11, 0.15) 0%, transparent 70%);
        padding: var(--space-16) 0;
        text-align: center;
    }

    .blog-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
        gap: var(--space-6);
        margin: var(--space-8) 0;
    }

    .blog-card {
        background: var(--bg-card);
        border: 1px solid var(--border-2);
        border-radius: var(--radius-xl);
        overflow: hidden;
        transition: all var(--transition-base);
        height: 100%;
        display: flex;
        flex-direction: column;
    }

    .blog-card:hover {
        transform: translateY(-8px);
        border-color: var(--aurora-gold);
        box-shadow: var(--shadow-gold);
    }

    .blog-image {
        width: 100%;
        height: 200px;
        background: linear-gradient(135deg, var(--aurora-gold), var(--aurora-amber));
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 3rem;
        position: relative;
        overflow: hidden;
    }

    .blog-image::before {
        content: '';
        position: absolute;
        top: -50%;
        left: -50%;
        width: 200%;
        height: 200%;
        background: radial-gradient(circle at 30% 30%, rgba(255,255,255,0.2) 0%, transparent 50%);
        animation: rotate 20s linear infinite;
    }

    @keyframes rotate {
        from { transform: rotate(0deg); }
        to { transform: rotate(360deg); }
    }

    .blog-content {
        padding: var(--space-6);
        flex: 1;
        display: flex;
        flex-direction: column;
    }

    .blog-category {
        display: inline-block;
        padding: 4px 12px;
        background: rgba(245, 158, 11, 0.2);
        color: #fde68a;
        border-radius: var(--radius-full);
        font-size: 0.7rem;
        font-weight: 700;
        margin-bottom: var(--space-3);
        width: fit-content;
    }

    .blog-title {
        font-size: 1.3rem;
        margin-bottom: var(--space-3);
        color: var(--text-primary);
        line-height: 1.4;
    }

    .blog-title a {
        color: var(--text-primary);
        text-decoration: none;
        transition: color var(--transition-fast);
    }

    .blog-title a:hover {
        color: var(--aurora-gold);
    }

    .blog-excerpt {
        color: var(--text-tertiary);
        font-size: 0.95rem;
        line-height: 1.6;
        margin-bottom: var(--space-4);
        flex: 1;
    }

    .blog-meta {
        display: flex;
        justify-content: space-between;
        align-items: center;
        color: var(--text-quaternary);
        font-size: 0.85rem;
        border-top: 1px solid var(--border-1);
        padding-top: var(--space-4);
        margin-top: auto;
    }

    .blog-author {
        display: flex;
        align-items: center;
        gap: var(--space-2);
    }

    .read-more {
        color: var(--aurora-gold);
        font-weight: 700;
        transition: all var(--transition-fast);
        text-decoration: none;
    }

    .read-more:hover {
        transform: translateX(-5px);
        color: #fbbf24;
    }

    .loading-state {
        text-align: center;
        padding: var(--space-16);
        color: var(--text-tertiary);
    }

    .loading-state .spinner {
        margin: 0 auto var(--space-4);
    }

    .error-state {
        text-align: center;
        padding: var(--space-16);
        color: #fecaca;
        background: rgba(239, 68, 68, 0.1);
        border-radius: var(--radius-xl);
        border: 1px solid rgba(239, 68, 68, 0.3);
    }

    .pagination {
        display: flex;
        justify-content: center;
        gap: var(--space-2);
        margin: var(--space-8) 0;
        flex-wrap: wrap;
    }

    .page-link {
        padding: var(--space-2) var(--space-4);
        background: var(--bg-glass);
        border: 1px solid var(--border-2);
        border-radius: var(--radius-lg);
        color: var(--text-secondary);
        transition: all var(--transition-fast);
        text-decoration: none;
        cursor: pointer;
    }

    .page-link:hover,
    .page-link.active {
        background: rgba(245, 158, 11, 0.2);
        border-color: var(--aurora-gold);
        color: #fde68a;
    }

    .featured-post {
        grid-column: 1 / -1;
        margin-bottom: var(--space-8);
    }

    .featured-post .blog-card {
        display: grid;
        grid-template-columns: 300px 1fr;
        gap: 0;
    }

    .featured-post .blog-image {
        height: 100%;
    }

    @media (max-width: 768px) {
        .featured-post .blog-card {
            grid-template-columns: 1fr;
        }

        .featured-post .blog-image {
            height: 200px;
        }

        .blog-grid {
            grid-template-columns: 1fr;
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="container">
    <!-- Hero Section -->
    <div class="blog-hero">
        <span class="hero-icon">ğŸ“</span>
        <h1 class="hero-title">Ù…Ø¯ÙˆÙ†Ø© Ø§Ù„Ø£Ù…Ù† Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ</h1>
        <p class="hero-subtitle">
            Ù…Ù‚Ø§Ù„Ø§Øª ÙˆØ¯Ø±ÙˆØ³ ÙÙŠ Ø£Ù…Ù† Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ÙˆØ­Ù…Ø§ÙŠØ© Ø§Ù„Ø®ØµÙˆØµÙŠØ©
        </p>
    </div>

    <!-- Loading State -->
    <div id="loading-state" class="loading-state">
        <div class="spinner spinner-lg"></div>
        <p>Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù‚Ø§Ù„Ø§Øª...</p>
    </div>

    <!-- Error State (hidden by default) -->
    <div id="error-state" class="error-state" style="display: none;">
        <span style="font-size: 3rem; display: block; margin-bottom: var(--space-4);">âš ï¸</span>
        <h3>Ø¹Ø°Ø±Ø§Ù‹ØŒ Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù‚Ø§Ù„Ø§Øª</h3>
        <p>ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ Ù„Ø§Ø­Ù‚Ø§Ù‹</p>
    </div>

    <!-- Blog Posts Container (hidden by default) -->
    <div id="blog-container" style="display: none;">
        <!-- Featured Post -->
        <div id="featured-post-container" class="featured-post"></div>

        <!-- Blog Posts Grid -->
        <div id="blog-grid" class="blog-grid"></div>

        <!-- Pagination -->
        <div id="pagination" class="pagination"></div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
(function() {
    "use strict";

    // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª RSS
    const RSS_CONFIG = {
        // Ø±Ø§Ø¨Ø· RSS Ù„Ù…Ø¯ÙˆÙ†ØªÙƒ Ø¹Ù„Ù‰ Ø¨Ù„ÙˆØ¬Ø±
        feedUrl: 'https://smartaivideo.blogspot.com/feeds/posts/default?alt=rss',
        // Ø®Ø¯Ù…Ø© CORS proxy Ù„ØªØ¬Ù†Ø¨ Ù…Ø´Ø§ÙƒÙ„ Ø§Ù„Ø£Ù…Ø§Ù†
        proxyUrl: 'https://api.rss2json.com/v1/api.json?rss_url=',
        // Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ù‚Ø§Ù„Ø§Øª ÙÙŠ Ø§Ù„ØµÙØ­Ø©
        postsPerPage: 9,
        // Ø§Ù„Ø±Ù…ÙˆØ² Ø§Ù„ØªØ¹Ø¨ÙŠØ±ÙŠØ© Ù„Ù„Ù…Ù‚Ø§Ù„Ø§Øª (ÙƒØ¨Ø¯ÙŠÙ„ Ù„Ù„ØµÙˆØ±)
        icons: ['ğŸ“±', 'ğŸ“§', 'ğŸ”', 'ğŸ”—', 'ğŸŒ', 'ğŸ“', 'ğŸ‘¤', 'ğŸ”‘', 'ğŸ”¢', 'ğŸ’³', 'ğŸšª', 'ğŸ“', 'ğŸŒ', 'ğŸ”', 'ğŸ”‘', 'ğŸ§‘', 'ğŸ“„']
    };

    // Ø¹Ù†Ø§ØµØ± DOM
    const elements = {
        loading: document.getElementById('loading-state'),
        error: document.getElementById('error-state'),
        container: document.getElementById('blog-container'),
        featuredContainer: document.getElementById('featured-post-container'),
        gridContainer: document.getElementById('blog-grid'),
        paginationContainer: document.getElementById('pagination')
    };

    // Ù…ØªØºÙŠØ±Ø§Øª Ø¹Ø§Ù…Ø©
    let allPosts = [];
    let currentPage = 1;

    // Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù†Øµ Ù…Ù† HTML
    function stripHtml(html) {
        const tmp = document.createElement('div');
        tmp.innerHTML = html;
        return tmp.textContent || tmp.innerText || '';
    }

    // ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„ØªØ§Ø±ÙŠØ®
    function formatDate(dateString) {
        const date = new Date(dateString);
        return date.toLocaleDateString('ar-EG', {
            year: 'numeric',
            month: 'long',
            day: 'numeric'
        });
    }

    // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„ÙØ¦Ø© Ù…Ù† Ø§Ù„Ø¹Ù†ÙˆØ§Ù†
    function getCategoryFromTitle(title) {
        const categories = {
            'Ù‡Ø§ØªÙ': 'ğŸ“± Ù‡Ø§ØªÙ',
            'Ø¨Ø±ÙŠØ¯': 'ğŸ“§ Ø¨Ø±ÙŠØ¯',
            'ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±': 'ğŸ” ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø±ÙˆØ±',
            'Ø±Ø§Ø¨Ø·': 'ğŸ”— Ø±ÙˆØ§Ø¨Ø·',
            'DNS': 'ğŸŒ DNS',
            'IP': 'ğŸ“ IP',
            'Ù…Ù„Ù': 'ğŸ“ Ù…Ù„ÙØ§Øª',
            'JWT': 'ğŸ”‘ JWT',
            'API': 'ğŸ” API'
        };

        for (const [key, value] of Object.entries(categories)) {
            if (title.includes(key)) {
                return value;
            }
        }
        return 'ğŸ›¡ï¸ Ø£Ù…Ù† Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ';
    }

    // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø±Ù…Ø² Ù„Ù„Ù…Ù‚Ø§Ù„
    function getIconForPost(index) {
        return RSS_CONFIG.icons[index % RSS_CONFIG.icons.length];
    }

    // Ø¬Ù„Ø¨ Ø§Ù„Ù…Ù‚Ø§Ù„Ø§Øª Ù…Ù† RSS
    async function fetchPosts() {
        try {
            const response = await fetch(RSS_CONFIG.proxyUrl + encodeURIComponent(RSS_CONFIG.feedUrl));
            const data = await response.json();

            if (data.status === 'ok') {
                allPosts = data.items.map((item, index) => ({
                    title: item.title,
                    link: item.link,
                    pubDate: item.pubDate,
                    description: stripHtml(item.description).substring(0, 200) + '...',
                    author: item.author || 'ÙØ±ÙŠÙ‚ Ø§Ù„Ø£Ù…Ù†',
                    category: getCategoryFromTitle(item.title),
                    icon: getIconForPost(index)
                }));

                return true;
            } else {
                throw new Error('ÙØ´Ù„ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù‚Ø§Ù„Ø§Øª');
            }
        } catch (error) {
            console.error('RSS Error:', error);
            return false;
        }
    }

    // Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù‚Ø§Ù„Ø§Øª
    function displayPosts() {
        // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„ØªØ­Ù…ÙŠÙ„ ÙˆØ¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù…Ø­ØªÙˆÙ‰
        elements.loading.style.display = 'none';
        elements.container.style.display = 'block';

        if (allPosts.length === 0) {
            elements.error.style.display = 'block';
            elements.container.style.display = 'none';
            return;
        }

        // Ø§Ù„Ù…Ù‚Ø§Ù„ Ø§Ù„Ù…Ù…ÙŠØ² (Ø£Ø­Ø¯Ø« Ù…Ù‚Ø§Ù„)
        const featured = allPosts[0];
        elements.featuredContainer.innerHTML = `
            <div class="blog-card">
                <div class="blog-image">ğŸ“Œ</div>
                <div class="blog-content">
                    <span class="blog-category">Ù…Ù…ÙŠØ²</span>
                    <h2 class="blog-title"><a href="${featured.link}" target="_blank">${featured.title}</a></h2>
                    <p class="blog-excerpt">${featured.description}</p>
                    <div class="blog-meta">
                        <span class="blog-author">ğŸ‘¤ ${featured.author}</span>
                        <span>ğŸ“… ${formatDate(featured.pubDate)}</span>
                        <a href="${featured.link}" target="_blank" class="read-more">Ø§Ù‚Ø±Ø£ Ø§Ù„Ù…Ø²ÙŠØ¯ â†</a>
                    </div>
                </div>
            </div>
        `;

        // Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ù…Ù‚Ø§Ù„Ø§Øª (Ø¨Ø¹Ø¯ Ø§Ù„Ù…Ù‚Ø§Ù„ Ø§Ù„Ù…Ù…ÙŠØ²)
        const remainingPosts = allPosts.slice(1);
        displayPostsPage(remainingPosts, currentPage);
        setupPagination(remainingPosts.length);
    }

    // Ø¹Ø±Ø¶ ØµÙØ­Ø© Ù…Ø¹ÙŠÙ†Ø© Ù…Ù† Ø§Ù„Ù…Ù‚Ø§Ù„Ø§Øª
    function displayPostsPage(posts, page) {
        const start = (page - 1) * RSS_CONFIG.postsPerPage;
        const end = start + RSS_CONFIG.postsPerPage;
        const pagePosts = posts.slice(start, end);

        let html = '';
        pagePosts.forEach((post, index) => {
            html += `
                <div class="blog-card">
                    <div class="blog-image">${post.icon}</div>
                    <div class="blog-content">
                        <span class="blog-category">${post.category}</span>
                        <h3 class="blog-title"><a href="${post.link}" target="_blank">${post.title}</a></h3>
                        <p class="blog-excerpt">${post.description}</p>
                        <div class="blog-meta">
                            <span class="blog-author">ğŸ‘¤ ${post.author}</span>
                            <span>ğŸ“… ${formatDate(post.pubDate)}</span>
                            <a href="${post.link}" target="_blank" class="read-more">â†</a>
                        </div>
                    </div>
                </div>
            `;
        });

        elements.gridContainer.innerHTML = html;
    }

    // Ø¥Ø¹Ø¯Ø§Ø¯ Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ±Ù‚ÙŠÙ…
    function setupPagination(totalPosts) {
        const totalPages = Math.ceil(totalPosts / RSS_CONFIG.postsPerPage);

        if (totalPages <= 1) {
            elements.paginationContainer.innerHTML = '';
            return;
        }

        let paginationHtml = '';
        for (let i = 1; i <= totalPages; i++) {
            paginationHtml += `
                <a href="#" class="page-link ${i === currentPage ? 'active' : ''}" data-page="${i}">${i}</a>
            `;
        }

        elements.paginationContainer.innerHTML = paginationHtml;

        // Ø¥Ø¶Ø§ÙØ© event listeners Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ±Ù‚ÙŠÙ…
        document.querySelectorAll('.page-link').forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const page = parseInt(e.target.dataset.page);
                if (page && page !== currentPage) {
                    currentPage = page;
                    displayPostsPage(allPosts.slice(1), currentPage);

                    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ù†Ø´Ø·Ø©
                    document.querySelectorAll('.page-link').forEach(l => {
                        l.classList.remove('active');
                    });
                    e.target.classList.add('active');

                    // ØªÙ…Ø±ÙŠØ± Ù„Ø£Ø¹Ù„Ù‰ Ø§Ù„ØµÙØ­Ø© Ø¨Ø³Ù„Ø§Ø³Ø©
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                }
            });
        });
    }

    // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØµÙØ­Ø©
    async function init() {
        const success = await fetchPosts();

        if (success) {
            displayPosts();
        } else {
            elements.loading.style.display = 'none';
            elements.error.style.display = 'block';

            // Ø¹Ø±Ø¶ Ù…Ø­ØªÙˆÙ‰ ØªØ¬Ø±ÙŠØ¨ÙŠ ÙÙŠ Ø­Ø§Ù„Ø© Ø§Ù„ÙØ´Ù„
            allPosts = [
                {
                    title: 'ÙƒÙŠÙ ØªØ­Ù…ÙŠ Ù†ÙØ³Ùƒ Ù…Ù† Ø§Ù„Ø§Ø­ØªÙŠØ§Ù„ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ',
                    link: '#',
                    pubDate: new Date().toISOString(),
                    description: 'Ø¯Ù„ÙŠÙ„ Ø´Ø§Ù…Ù„ Ù„Ù„ØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ø£Ø³Ø§Ù„ÙŠØ¨ Ø§Ù„Ø§Ø­ØªÙŠØ§Ù„ Ø§Ù„Ø­Ø¯ÙŠØ«Ø© ÙˆØ·Ø±Ù‚ Ø§Ù„Ø­Ù…Ø§ÙŠØ© Ù…Ù†Ù‡Ø§',
                    author: 'ÙØ±ÙŠÙ‚ Ø§Ù„Ø£Ù…Ù†',
                    category: 'ğŸ›¡ï¸ Ø£Ù…Ù† Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ',
                    icon: 'ğŸš¨'
                },
                {
                    title: 'Ø£ÙØ¶Ù„ Ø£Ø¯ÙˆØ§Øª ÙØ­Øµ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ',
                    link: '#',
                    pubDate: new Date().toISOString(),
                    description: 'ØªØ¹Ø±Ù Ø¹Ù„Ù‰ ÙƒÙŠÙÙŠØ© ÙƒØ´Ù Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ù…Ø²ÙŠÙ ÙˆØ§Ù„Ù…Ø¤Ù‚Øª Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø£Ø¯ÙˆØ§ØªÙ†Ø§ Ø§Ù„Ù…ØªØ·ÙˆØ±Ø©',
                    author: 'ÙØ±ÙŠÙ‚ Ø§Ù„Ø£Ù…Ù†',
                    category: 'ğŸ“§ Ø¨Ø±ÙŠØ¯',
                    icon: 'ğŸ“§'
                },
                {
                    title: 'ÙƒÙŠÙ ØªÙ†Ø´Ø¦ ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ù‚ÙˆÙŠØ© Ù„Ø§ ØªÙØ®ØªØ±Ù‚',
                    link: '#',
                    pubDate: new Date().toISOString(),
                    description: 'Ù†ØµØ§Ø¦Ø­ ÙˆØ¥Ø±Ø´Ø§Ø¯Ø§Øª Ù„Ø¥Ù†Ø´Ø§Ø¡ ÙƒÙ„Ù…Ø§Øª Ù…Ø±ÙˆØ± Ù‚ÙˆÙŠØ© ÙˆØ­Ù…Ø§ÙŠØ© Ø­Ø³Ø§Ø¨Ø§ØªÙƒ',
                    author: 'ÙØ±ÙŠÙ‚ Ø§Ù„Ø£Ù…Ù†',
                    category: 'ğŸ” ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø±ÙˆØ±',
                    icon: 'ğŸ”'
                }
            ];
            displayPosts();
        }
    }

    // Ø¨Ø¯Ø¡ Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
    init();

})();
</script>
{% endblock %}